"use strict";let e,t=!1,n=0,s=!1,r=!1;const o=chrome.runtime.getURL("assets/n.mp3"),l=new Audio(o);window.onload=e=>{if(!e.target.location.hostname.includes("relay.amazon.")&&!e.target.location.pathname.includes("/loadboard/search"))return;if(!document.getElementById("multi-work-container"))return;const t=document.getElementsByClassName("tab-panel")[0],n=document.getElementsByClassName("search__panel")[0],s=document.getElementsByClassName("css-1oino5a")[0];if(!t){if(!n)return;return n.onclick=()=>{setTimeout((()=>{const e=document.getElementById("popover-2");e&&(e.onclick=e=>{e.target.textContent.includes("Load Board Home")||d()})}),300)},s.onclick=()=>{setTimeout((()=>{d()}),300)},void c()}t.onclick=e=>{"Load Board Home"!==e.target.textContent.trim()&&d()},s.onclick=()=>{setTimeout((()=>{d()}),300)},a()};const a=()=>window.onresize=()=>{t=!1;const e=document.getElementById("refresher-stop"),n=document.getElementById("refresher-start");e&&(e.style.display="none"),n&&(n.style.display="block");const s=document.getElementsByClassName("active")[0];if(!s){const e=document.getElementsByClassName("search__panel")[0];if(!e)return;if(e.onclick=()=>{setTimeout((()=>{const e=document.getElementById("popover-2");e&&(e.onclick=e=>{e.target.textContent.includes("Load Board Home")||d()})}),300)},e.textContent.includes("Load Board Home"))return;if(document.getElementById("control-panel-refresher"))return;return void d()}if("Load Board Home"===s.textContent.trim())return;document.getElementById("control-panel-refresher")||d()},c=()=>window.onresize=()=>{t=!1;const e=document.getElementById("refresher-stop"),n=document.getElementById("refresher-start");e&&(e.style.display="none"),n&&(n.style.display="block");const s=document.getElementsByClassName("active")[0];if(!s){const e=document.getElementsByClassName("search__panel")[0];if(!e)return;if(e.textContent.includes("Load Board Home"))return;if(document.getElementById("control-panel-refresher"))return;return void d()}if(document.getElementsByClassName("tab-panel")[0].onclick=e=>{"Load Board Home"!==e.target.textContent.trim()&&d()},"Load Board Home"===s.textContent.trim())return;document.getElementById("control-panel-refresher")||d()},d=()=>{s=!1,r=!1;let e=document.getElementById("utility-bar");if(e){const t=document.getElementById("control-panel-refresher");t&&t.remove(),i().then((t=>{const n=t;e.children[0].prepend(n),m(),u(),h(),setTimeout((()=>{const t=e.querySelector(".css-hkr77h");t&&"true"===t.ariaChecked&&t.click()}),300)}))}else{let t=setInterval((()=>{e=document.getElementById("utility-bar"),e&&i().then((n=>{const s=n;e.children[0].prepend(s),m(),u(),h();const r=e.querySelector(".css-hkr77h");r&&"true"===r.ariaChecked&&r.click(),clearInterval(t)}))}),150)}},i=async()=>{const e=document.createElement("div");e.id="control-panel-refresher";const t=chrome.runtime.getURL("assets/onBtn2.png"),n=chrome.runtime.getURL("assets/offBtn.png");return e.innerHTML=`\n    <div class="refresher__params">\n      <div class="refresher-slider">\n        <input type="range" min="300" max="1500" value="300" step="100" class="refresher__slider" id="refresher-range">\n        <p>Value: <span id="refresher-range-value"></span> ms</p>\n      </div>\n      <div class="refresher__params-row">\n        <div class="refresher__params-col">\n          <p class="refresher-sw">\n            <label class="refresher__switch">\n              <input type="checkbox">\n              <span class="refresher__switch-slider round" id="sot"></span>\n            </label>\n            <span>Show at the top</span>\n          </p>\n          <p class="refresher-sw">\n            <label class="refresher__switch">\n              <input type="checkbox">\n              <span class="refresher__switch-slider round" id="eb"></span>\n            </label>\n            <span>Easy book</span>\n          </p>\n        </div>\n        <div class="refresher__params-col">\n          <p class="refresher-sw">\n            <label class="refresher__switch">\n              <input type="checkbox">\n              <span class="refresher__switch-slider round" id="sd"></span>\n            </label>\n            <span>Show details</span>\n          </p>\n          <p class="refresher-sw">\n            <label class="refresher__switch">\n              <input type="checkbox">\n              <span class="refresher__switch-slider round" id="au"></span>\n            </label>\n            <span>Auto book</span>\n          </p>\n        </div>\n      </div>\n    </div>\n    <div class="refresher__action-row">\n      <img class="refresher__action-btn" id="refresher-start" src="${t}" alt="start">\n      <img class="refresher__action-btn" id="refresher-stop" src="${n}" alt="stop">\n    </div>\n  `,e},m=()=>{const n=document.getElementById("refresher-stop"),s=document.getElementById("refresher-start"),r=document.getElementsByClassName("css-q7ppch")[0];t?(n.style.display="block",s.style.display="none"):(n.style.display="none",s.style.display="block"),document.onclick=o=>(document.getElementById("control-panel-refresher")||setTimeout((()=>{document.getElementsByClassName("utility-bar")[0]&&d()})),o.target!=r&&o.target!=r.childNodes[0]&&t?(t=!1,n.style.display="none",s.style.display="block",void clearInterval(e)):o.target.id===s.id?(t=!0,n.style.display="block",s.style.display="none",void y(r)):void 0)},u=()=>{const e=document.getElementById("refresher-range"),t=document.getElementById("refresher-range-value");t.innerHTML=e.value,n=e.value,e.oninput=function(){t.innerHTML=this.value,n=this.value}},h=()=>{const e=document.getElementById("sot"),t=document.getElementById("eb"),n=document.getElementById("sd"),o=document.getElementById("au");e.onclick=()=>{s=!s},t.onclick=()=>{r=!r,r?v():k()},n.onclick=()=>{},o.onclick=()=>{}},p=e=>{e&&e.click()},y=r=>{let o=!0,a=new Set,c=new Set;const d=document.getElementById("refresher-stop"),i=document.getElementById("refresher-start");t&&(e=setInterval((async()=>{const t=document.getElementsByClassName("load-list")[0];if(!t||0===t.length)return;if(o)return 0===a.size&&(a=g(t),c=new Set),o=!1,void p(r);const n=g(t);if(c=await f(n,a),c.size>0){clearInterval(e),o=!0,a=new Set,s&&E(c,t),B(c),d.style.display="none",i.style.display="block";const n=l.play();void 0!==n&&n.then((e=>{console.log("Playback started")})).catch((e=>{console.log(e)}))}else p(r)}),n))},g=e=>{let t=new Set;return e.childNodes.forEach((e=>{const n=e.childNodes[0].id+e.getElementsByClassName("css-11tnikh")[1].textContent;t.add(n)})),t},f=async(e,t)=>{if(!e||!t)return;if(e.size!==t.size)return;let n=new Set;return[...e].forEach((e=>{t.has(e)||n.add(e)})),n},B=async e=>{e&&[...e].forEach((e=>{const t=document.getElementById(e.split(" ")[0]).parentNode;t&&(t.style.backgroundColor="#a3cef0")}))},E=(e,t)=>{console.log(!e||!t||0===t.length||0===e.size),e&&t&&0!==t.length&&0!==e.size&&[...e].forEach((e=>{console.log(e.split(" ")[0]);const n=document.getElementById(e.split(" ")[0]).parentNode;if(!n)return;const s=n.cloneNode(!0);n.remove(),t.insertBefore(s,t.childNodes[0]),console.log(s,t)}))},v=()=>{const e=document.getElementsByClassName("load-list")[0];e&&0!==e.length&&e.childNodes.forEach((e=>{const t=b();e.getElementsByClassName("ebBtn")[0]||e.childNodes[0].childNodes[0].appendChild(t)}))},k=()=>{const e=document.getElementsByClassName("load-list")[0];e&&0!==e.length&&e.childNodes.forEach((e=>{e.getElementsByClassName("ebBtn")[0]&&e.getElementsByClassName("ebBtn")[0].remove()}))},b=()=>{const e=document.createElement("button");return e.textContent="EasyBook",e.classList.add("ebBtn"),e.onclick=()=>{},e};
